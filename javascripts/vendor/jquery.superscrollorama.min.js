(function(a){a.superscrollorama=function(r){var e=this;var h={isVertical:true,triggerAtCenter:true,playoutAnimations:true,reverse:true};e.settings=a.extend({},h,r);var d=a(window);var c=[],f=[],l={x:0,y:0},n=false,q,j;function p(){d.scroll(function(){n=true});TweenLite.ticker.addEventListener("tick",o)}function b(i){var s={top:parseFloat(i.css("top")),left:parseFloat(i.css("left"))};if(isNaN(s.top)){s.top=0}if(isNaN(s.left)){s.left=0}return s}function o(){if(n){m();n=false}}function g(i){i.el.css("position",i.origPositioning.pos);i.el.css("top",i.origPositioning.top);i.el.css("left",i.origPositioning.left)}function k(s,i){if(s){if(s.totalProgress){s.totalProgress(i).pause()}else{s.progress(i).pause()}}}function m(){var N=e.settings.isVertical?d.scrollTop()+l.y:d.scrollLeft()+l.x;var z=e.settings.triggerAtCenter?(e.settings.isVertical?-d.height()/2:-d.width()/2):0;var K,H,F;var D=c.length;for(K=0;K<D;K++){var s=c[K],O=s.target,y=s.offset;if(typeof(O)==="string"){q=a(O).offset()||{};H=e.settings.isVertical?q.top+l.y:q.left+l.x;y+=z}else{if(typeof(O)==="number"){H=O}else{if(a.isFunction(O)){H=O.call(this)}else{q=O.offset();H=e.settings.isVertical?q.top+l.y:q.left+l.x;y+=z}}}H+=y;F=H+s.dur;if((N>H&&N<F)&&s.state!=="TWEENING"){s.state="TWEENING";s.start=H;s.end=F}if(N<H&&s.state!=="BEFORE"&&s.reverse){if(e.settings.playoutAnimations||s.dur===0){s.tween.reverse()}else{k(s.tween,0)}s.state="BEFORE"}else{if(N>F&&s.state!=="AFTER"){if(e.settings.playoutAnimations||s.dur===0){s.tween.play()}else{k(s.tween,1)}s.state="AFTER"}else{if(s.state==="TWEENING"){var I=false;if(s.tween.repeat){I=(s.tween.repeat()===-1)}if(I){var A=s.tween.totalProgress();if(s.playeadLastPosition===null||A===s.playeadLastPosition){if(A===1){if(s.tween.yoyo()){s.tween.reverse()}else{s.tween.totalProgress(0).play()}}else{s.tween.play()}}s.playeadLastPosition=A}else{k(s.tween,(N-s.start)/(s.end-s.start))}}}}}var x=f.length;for(K=0;K<x;K++){var J=f[K];var t=J.el;if(J.state!=="PINNED"){var G=J.spacer.offset();if(J.state==="UPDATE"){g(J)}H=e.settings.isVertical?G.top+l.y:G.left+l.x;H+=J.offset;F=H+J.dur;var u=((N>F&&J.state==="BEFORE")||(N<H&&J.state==="AFTER"));var B=(N>H&&N<F);if(B||u){if(J.pushFollowers&&t.css("position")==="static"){t.css("position","relative")}J.origPositioning={pos:t.css("position"),top:J.spacer.css("top"),left:J.spacer.css("left")};J.fixedPositioning={top:e.settings.isVertical?-J.offset:G.top,left:e.settings.isVertical?G.left:-J.offset};t.css("position","fixed");t.css("top",J.fixedPositioning.top);t.css("left",J.fixedPositioning.left);J.pinStart=H;J.pinEnd=F;if(J.pushFollowers){if(e.settings.isVertical){J.spacer.height(J.dur+t.outerHeight())}else{J.spacer.width(J.dur+t.outerWidth())}}else{if(J.origPositioning.pos==="absolute"){J.spacer.width(0);J.spacer.height(0)}else{if(e.settings.isVertical){J.spacer.height(t.outerHeight())}else{J.spacer.width(t.outerWidth())}}}if(J.state==="UPDATE"){if(J.anim){k(J.anim,0)}}else{if(J.onPin){J.onPin(J.state==="AFTER")}}J.state="PINNED"}}if(J.state==="PINNED"){if(N<J.pinStart||N>J.pinEnd){var E=N<J.pinStart;J.state=E?"BEFORE":"AFTER";k(J.anim,E?0:1);var C=E?0:J.dur;if(e.settings.isVertical){J.spacer.height(J.pushFollowers?C:0)}else{J.spacer.width(J.pushFollowers?C:0)}var v=J.fixedPositioning.top-b(J.el).top;var w=J.fixedPositioning.left-b(J.el).left;g(J);if(!J.pushFollowers||J.origPositioning.pos==="absolute"){var M;if(J.origPositioning.pos==="relative"){M=e.settings.isVertical?parseFloat(J.origPositioning.top):parseFloat(J.origPositioning.left);if(isNaN(M)){M=0}}else{M=e.settings.isVertical?J.spacer.position().top:J.spacer.position().left}var L=e.settings.isVertical?"top":"left";J.el.css(L,M+C)}if(v!==0){J.el.css("top",b(J.el).top-v)}if(w!==0){J.el.css("left",b(J.el).left-w)}if(J.onUnpin){J.onUnpin(!E)}}else{if(J.anim){k(J.anim,(N-J.pinStart)/(J.pinEnd-J.pinStart))}}}}}e.addTween=function(u,s,t,v,i){s.pause();c.push({target:u,tween:s,offset:v||0,dur:t||0,reverse:(typeof i!=="undefined")?i:e.settings.reverse,state:"BEFORE"});return e};e.pin=function(t,s,v){if(typeof(t)==="string"){t=a(t)}var u={offset:0,pushFollowers:true};v=a.extend({},u,v);if(v.anim){v.anim.pause()}var i=a('<div class="superscrollorama-pin-spacer"></div>');i.css("position","relative");i.css("top",t.css("top"));i.css("left",t.css("left"));t.before(i);f.push({el:t,state:"BEFORE",dur:s,offset:v.offset,anim:v.anim,pushFollowers:v.pushFollowers,spacer:i,onPin:v.onPin,onUnpin:v.onUnpin});return e};e.updatePin=function(t,s,v){if(typeof(t)==="string"){t=a(t)}if(v.anim){v.anim.pause()}var i=f.length;for(j=0;j<i;j++){var u=f[j];if(t.get(0)===u.el.get(0)){if(s){u.dur=s}if(v.anim){u.anim=v.anim}if(v.offset){u.offset=v.offset}if(typeof v.pushFollowers!=="undefined"){u.pushFollowers=v.pushFollowers}if(v.onPin){u.onPin=v.onPin}if(v.onUnpin){u.onUnpin=v.onUnpin}if((s||v.anim||v.offset)&&u.state==="PINNED"){u.state="UPDATE";m()}}}return e};e.removeTween=function(w,s,u){var t=c.length;if(typeof u==="undefined"){u=true}for(var i=0;i<t;i++){var v=c[i];if(v.target===w&&(!s||v.tween===s)){c.splice(i,1);if(u){k(v.tween,0)}t--;i--}}return e};e.removePin=function(s,u){if(typeof(s)==="string"){s=a(s)}if(typeof u==="undefined"){u=true}var t=f.length;for(var i=0;i<t;i++){var v=f[i];if(v.el.is(s)){f.splice(i,1);if(u){v.spacer.remove();g(v);if(v.anim){k(v.anim,0)}}t--;i--}}return e};e.setScrollContainerOffset=function(i,s){l.x=i;l.y=s;return e};e.triggerCheckAnim=function(i){if(i){m()}else{n=true}return e};p();return e}})(jQuery);